<div style="padding:15px">
    <h2 style="margin-bottom:0">BYU OIT AV Monitoring Information</h2>
    <div style="color:silver"><b>S</b>elf <b>M</b>onitoring <b>E</b>rror <b>E</b>ngine</div>

    <h3>Summary</h3>
    <p>
        This monitoring tool is intended to provide visibility for support teams into the current state of the A/V control systems on campus.<br /> Alerts are generated based on events received from devices, or based on conditions that exist in those
        devices' current state.<br /> For example, an event indicating that a wireless microphone battery has less than 90 minutes of charge generates an immediate alert based on that event.<br /> A system offline alert is generated when the state record
        indicates that the last heartbeat was received more than 5 minutes ago. This is checked every 30 seconds<br /> Below is a table of all of the alerts being generated by the system, including the triggers, intervals and the clearing triggers for
        each.
    </p>

    <h3>Critical Alerts</h3>
    <table>
        <tr>
            <th>Alert Name</th>
            <th style="min-width:200px">Description</th>
            <th>Applies to</th>
            <th style="width:200px">Trigger</th>
            <th style="width:200px">Clearing Trigger</th>
        </tr>
        <tr>
            <td>Device Communication Error</td>
            <td>For DMPS systems, events are sent if the DMPS loses communication with any of the displays.</td>
            <td>DMPS</td>
            <td>event | key: responsive | value: No Response</td>
            <td>event | key: responsive | value: Ok</td>
        </tr>
        <tr>
            <td>Device Offline</td>
            <td>For DMPS systems, events are sent if the DMPS reports a display as offline.</td>
            <td>DMPS</td>
            <td>event | key: online | value: Offline</td>
            <td>event | key: online | value: Online</td>
        </tr>
        <tr>
            <td>Device Unsecure</td>
            <td>For DMPS systems, if the connection between the security pins is broken, an event is generated. This error is for displays.</td>
            <td>DMPS</td>
            <td>event | key: secure | value: False</td>
            <td>event | key: secure | value: True</td>
        </tr>
        <tr>
            <td>Help Request</td>
            <td>Help requests can apply to any room/system, and are generated in one of two ways. First, if someone pushes the help request button on a Pi system, a Help Request alert is automatically generated. Second, if a users call into the AV Help Desk,
                clerks use the "New Help Request" button to fill out notes about the user, room and issue, and then a Help Request alert is generated.
            </td>
            <td>Pi | DMPS</td>
            <td>event | key:help-request | value: confirm<br /> Manual Entry</td>
            <td>Manual Resolution</td>
        </tr>
        <tr>
            <td>Open Cabinet</td>
            <td>For DMPS systems, if the connection between the security pins is broken, an event is generated. This error is for the cabinet.</td>
            <td>DMPS</td>
            <td>event | key: active | value: True</td>
            <td>event | key: active | value: False</td>
        </tr>
        <tr>
            <td>System communication error</td>
            <td>For all systems, every time the state of the system is received, a timestamp is updated. If no state has been received for 10 minutes, this alert is generated.</td>
            <td>Pi | DMPS</td>
            <td>interval: 30s | ('DeviceType' == 'control-processor' || 'DeviceType' == 'dmps') &amp;&amp; 'LastStateReceived' &lt; '-10m'</td>
            <td>interval: 30s | (DeviceID == Alert.DeviceID &amp;&amp; 'LastStateReceived' &gt; '-10m'</td>
        </tr>
        <tr>
            <td>System offline error</td>
            <td>For all systems, the control processors report heartbeats as events. When that event is received, a timestamp is updated. If no heartbead has been reported for 6 minutes, an alert is generated</td>
            <td>Pi | DMPS</td>
            <td>interval: 30s | ('DeviceType' == 'control-processor' || 'DeviceType' == 'dmps') &amp;&amp; 'LastHeartbeat' &lt; '-6m'</td>
            <td>interval: 30s | (DeviceID == Alert.DeviceID &amp;&amp; 'LastHeartbeat' &gt; '-6m'</td>
        </tr>
        <tr>
            <td>Touchpanel offline</td>
            <td>For DMPS systems, the DMPS will report if it has lost connection to one or more of its touch panels via an event.
            </td>
            <td>DMPS</td>
            <td>event | key:tp_online | value:Offline</td>
            <td>event | key:tp_online | value:Online</td>
        </tr>
        <tr>
            <td>Websocket communicaton error</td>
            <td>For Pi systems, the touch interface maintains a connection with devices and the control processor api. This is called a Web Socket. The number of those connections is reported as a state variable on the control processor. If the number of
                web sockets is zero, and it has been zero for more than 1 minute, then an alert is generated, indicating that the UI would not function if someone tried to use it.</td>
            <td>Pi</td>
            <td>interval: 150s 'DeviceType' == 'control-processor' && 'WebsocketCount' == '0' && 'UpdateTimes.websocket-count' &lt; '-1m'</td>
            <td>interval: 10s 'DeviceID' == 'Alert.DeviceID' && 'WebsocketCount' > '0'</td>
        </tr>
        <tr>
            <td>Wireless Interference</td>
            <td>For DMPS systems with a Shure wireless receiver, if wireless interference is detected, an event is issued indicating such. This usually indicates that there are multiple microhpones active on the same channel, but may also indicate some other
                device causing radio interference. Since this event is always transtiory (short-lived), we do not clear the alert until no interference is detected for 3 minutes</td>
            <td>DMPS</td>
            <td>event | key: interference | value: Interference Detected</td>
            <td>interval: 1m | 'DeviceID' == '.Alert.DeviceID' && 'Interference' == '' && 'UpdateTimes.interference' &lt; '-3m'
            </td>
        </tr>
        <tr>
            <td>Wireless Mic Battery</td>
            <td>For all systems, if a wireless mic battery reports an event with less than 90 minutes of charge avaiable, a critical alert is generated.</td>
            <td>Pi | DMPS</td>
            <td>event | key: battery-charge-minutes | value: &lt; 90<br /><span style="color:silver">(regex: <code>^0*(([1-8][0-9])|([1-9])|90)$</code>)</span></td>
            <td>event | key: battery-charge-minutes | value: &gt;= 90<br /><span style="color:silver">(regex: <code>^0*(([9][1-9])|[1-9][0-9]&#123;2,&#125;)$</code>)</span></td>
        </tr>
    </table>

    <h3>Warning Alerts</h3>
    <table>
        <tr>
            <th>Alert Name</th>
            <th style="min-width:200px">Description</th>
            <th>Applies to</th>
            <th style="width:200px">Trigger</th>
            <th style="width:200px">Clearing Trigger</th>
        </tr>
        <tr>
            <td>Lamp Hours</td>
            <td>For DMPS systems, lamp hours are reported. For Panasonic EZ770 and EZ570 models, if the lamp hours reaches 2900, then an alert is generated.</td>
            <td>DMPS</td>
            <td>interval:30s | 'DeviceType' == 'display' &amp;&amp; 'HardwareVersion' *= '^(Panasonic).*((EZ770)|(EZ570))' &amp;&amp; 'LampHours' &gt; '2899'</td>
            <td>interval:10s | 'LampHours' &lt; '2900' &amp;&amp; 'DeviceID' == Alert.DeviceID</td>
        </tr>
    </table>

    <h3>Low Severity Alerts</h3>
    <table>
        <tr>
            <th>Alert Name</th>
            <th style="min-width:200px">Description</th>
            <th>Applies to</th>
            <th style="width:200px">Trigger</th>
            <th style="width:200px">Clearing Trigger</th>
        </tr>
        <tr>
            <td>CPU Temperature</td>
            <td>For Pi control systems, the cpu temperature is reported. If it reaches 80&deg;F or above, the alert is triggered. Lower than that, and the alert is cleared</td>
            <td>Pi</td>
            <td>event | key: cpu-thermal0-temp | value: &gt;= 80<br /><span style="color:silver">(regex: <code>^([8-9][0-9]|[1-9][0-9]&#123;2,&#125;)$</code>)</span></td>
            <td>event | key: cpu-thermal0-temp | value: &lt; 80<br /><span style="color:silver">(regex: <code>^0*([0-9]|[1-7][0-9])$</code>)</span></td>
        </tr>
        <tr>
            <td>Display Temperature</td>
            <td>For DMPS systems, displays temperature is reported. If it is over 109 degrees, an alert is generated</td>
            <td>DMPS</td>
            <td>interval: 30s | DeviceType == display && Temperature &gt; 109</td>
            <td>interval: 30s | DeviceType == display && Temperature &lt; 110</td>
        </tr>
        <tr>
            <td>Memory Usage</td>
            <td>For Pi systems, memory usage is reported. If it reaches more than 90%, an alert is generated</td>
            <td>DMPS</td>
            <td>event | key: v-mem-used-percent | &gt;=90<br /><span style="color:silver">(regex: <code>^([9][0-9]|[1-9][0-9]&#123;2,&#125;)$</code>)</span></td>
            <td>event | key: v-mem-used-percent | &lt;90<br /><span style="color:silver">(regex: <code>^0*([0-9]|[1-8][0-9])$</code>)</span></td>
        </tr>
        <tr>
            <td>Wireless Mic Battery</td>
            <td>For all systems, if a wireless mic battery reports an event with less than 300 minutes of charge avaiable, a low severity alert is generated. If that amount reaches less than 90, the low severity alert is closed and a critical alert is generated.</td>
            <td>Pi | DMPS</td>
            <td>event | key: battery-charge-minutes | value: &lt; 300 && &gt;= 90<br /><span style="color:silver">(regex: <code>^0*(([1-2][0-9][0-9]$)|([9][-0-9])$)</code>)</span></td>
            <td>event | key: battery-charge-minutes | value: &gt;= 300 || &lt; 90<br /><span style="color:silver">(regex: <code>^0*((([3-9]\\d&#123;2,&#125;)|([1-9]\\d&#123;3,&#125;))|([1-8][0-9]$)|([0-9]$))</code>)</span></td>
        </tr>
        <tr>
            <td>Wireless Mic Battery Type</td>
            <td>For all systems, if a wireless mic battery reports a battery type of ALKA in its state, an alert is generated</td>
            <td>Pi | DMPS</td>
            <td>interval: 30s | 'DeviceType' == 'microphone' &amp;&amp; 'BatteryType' == 'ALKA'</td>
            <td>interval: 30s | 'DeviceID' == 'Alert.DeviceID' &amp;&amp; 'BatteryType' != 'ALKA'</td>
        </tr>
        <tr>
            <td>Wireless Receiver Error</td>
            <td>For DMPS systems, this alert was intended to indicate a problem with the wireless receiver itself. However, there is a bug in the DMPS monitoring code causing it to report the signal indicating any problem with any wireless device (including
                microphone battery types and levels), so this alert is currently over-inclusive. If it is the only microphone error on a room, then it indicates a problem with the wireless receiver.</td>
            <td>DMPS</td>
            <td>event | key:mic-alerting | value:Error</td>
            <td>event | key:mic-alerting | value:Okay</td>
        </tr>
    </table>
</div>