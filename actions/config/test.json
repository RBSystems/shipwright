[{"name":"dmps-open-cabinet-add-alert","trigger":"event","if":{"event-match":{"key":"active","value":"True"}},"then":[{"do":"upsert-alert","with":{"buildingID":"{{.Event.TargetDevice.BuildingID}}","roomID":"{{.Event.TargetDevice.RoomID}}","deviceID":"{{.Event.TargetDevice.DeviceID}}","type":"Open Cabinet","category":"Security","severity":"Critical","message":"{{.Event.TargetDevice.DeviceID}} is reporting an Open Cabinet","data":"{{.Event.Data}}","active":true}}]},{"name":"dmps-open-cabinet-alert-init","trigger":"alert-init","if":{"alert-match":{"type":"Open Cabinet"}},"then":[{"do":"add-action","with":{"name":"dmps-close-cabinet-{{.Alert.DeviceID}}","trigger":"event","if":{"event-match":{"key":"active","value":"False","target-device":{"deviceID":"{{.Alert.DeviceID}}"}}},"then":[{"do":"upsert-alert","with":{"deviceID":"[[.Event.TargetDevice.DeviceID]]","type":"Open Cabinet","category":"Security","active":false,"message":"[[.Event.TargetDevice.DeviceID]] Open Cabinet signal has cleared"}}]}}]}]